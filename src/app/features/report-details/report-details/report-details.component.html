<ngx-loading [show]="loading" [config]="{ backdropBorderRadius: '0px' }"></ngx-loading>
<div class="card card-header rounded-0 p-2">
  <div class="row" *ngIf="!reportDefinition">
    <div class="col-7 pt-1">
      <h5>New Report</h5>
    </div>
  </div>
  <div class="row" *ngIf="reportDefinition">
    <div class="col-7 pt-1">
      <h5 class="mb-0">{{reportDefinition.caption}}</h5>
    </div>
    <div class="col-2 pt-1">
      <h5 class="mb-0">version: {{reportDefinition.misQuery.fileVersion}}</h5>
    </div>
    <div class="col-2 pt-1">
      <h5 class="mb-0 badge badge-pill" [ngClass]="'badge-' + getStatusClass()">{{getStatus()}}</h5>
    </div>
    <div class="col-1">
      <div class="btn-group pull-right">
        <button class="btn btn-primary btn-sm" [routerLink]="['../dashboard/reports']"><i class="fa fa-arrow-left"></i></button>
      </div>
    </div>
  </div>
</div>
<div class="card rounded-0 card-body">
  <tabset type="pills">
    <tab heading="General" id="rpt-general" (select)="selectTab($event)">
      <app-general-info [editable]="editable" [reportDefinition]="reportDefinition" [selected]="selectedTab === 'rpt-cols'"></app-general-info>
    </tab>
    <tab heading="Columns" id="rpt-cols" (select)="selectTab($event)">
      <app-columns [reportDefinition]="reportDefinition" [selected]="selectedTab === 'rpt-cols'"></app-columns>
    </tab>
    <tab heading="Parameters" id="rpt-params" (select)="selectTab($event)">
      <app-parameters [reportDefinition]="reportDefinition"></app-parameters>
    </tab>
    <tab heading="Query" id="rpt-query" (select)="selectTab($event)">
      <app-query-editor [reportDefinition]="reportDefinition" [selected]="selectedTab === 'rpt-query'"></app-query-editor>
    </tab>
    <tab heading="Security" id="rpt-params" (select)="selectTab($event)">
      <app-security [reportDefinition]="reportDefinition"></app-security>
    </tab>
  </tabset>
</div>
<div class="card-body">
  <div class="float-right mb-3">
    <button class="btn btn-info" (click)="validateQuery()" ><i class="fa fa-check"></i> Validate</button>
    <button class="btn btn-primary"><i class="fa fa-save"></i> Save</button>
    <button class="btn"><i class="fa fa-remove"></i> Cancel</button>
  </div>
</div>